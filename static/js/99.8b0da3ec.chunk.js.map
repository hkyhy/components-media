{"version":3,"file":"static/js/99.8b0da3ec.chunk.js","mappings":"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","sources":["components/Speech/AudioRecordButton.js","components/Speech/AudioPlayerButton.js","../node_modules/@kne/use-ref-callback/src/index.js","../node_modules/react/cjs/react-jsx-runtime.production.min.js","../node_modules/react/jsx-runtime.js","components/Speech/README.md","../node_modules/readme/modules.js"],"sourcesContent":["import { useState, useRef } from 'react';\nimport { App } from 'antd';\nimport useRefCallback from '@kne/use-ref-callback';\nimport { createWithRemoteLoader } from '@kne/remote-loader';\n\nexport const useAudioRecord = options => {\n  const { onComplete, onData, onStart } = Object.assign({}, options);\n  const [recording, setRecording] = useState(false);\n  const audioRef = useRef([]);\n  const { message } = App.useApp();\n  const handlerComplete = useRefCallback(onComplete);\n  const handlerData = useRefCallback(onData);\n  const handlerStart = useRefCallback(onStart);\n  const start = useRefCallback(async () => {\n    const stream = await window.navigator.mediaDevices.getUserMedia({ audio: true }).catch(e => {\n      message.error('出错，请确保已允许浏览器获取录音权限');\n      throw e;\n    });\n    const recorder = new window.MediaRecorder(stream);\n    audioRef.current = { stream, recorder };\n    const events = [\n      [\n        'start',\n        () => {\n          audioRef.current.chunks = [];\n          handlerStart({ stream, recorder });\n        }\n      ],\n      [\n        'dataavailable',\n        e => {\n          handlerData(e.data);\n          audioRef.current.chunks.push(e.data);\n        }\n      ]\n    ];\n    audioRef.current.events = events;\n    events.forEach(([name, handler]) => recorder.addEventListener(name, handler));\n    recorder.start(1000);\n    setRecording(true);\n    return { stream, recorder };\n  });\n\n  const stop = useRefCallback(async isUnmount => {\n    !isUnmount && setRecording(false);\n    if (!audioRef.current) {\n      return [];\n    }\n    const { events, recorder, stream, chunks } = audioRef.current;\n    events.forEach(([name, handler]) => recorder.removeEventListener(name, handler));\n    stream.getTracks().forEach(track => track.stop());\n    audioRef.current = null;\n    await handlerComplete(chunks);\n    return chunks;\n  });\n\n  const change = useRefCallback(async () => {\n    if (recording) {\n      await stop();\n    } else {\n      await start();\n    }\n  });\n\n  return {\n    recording,\n    start,\n    stop,\n    change\n  };\n};\n\nexport const withAudioRecord = WrappedComponent => {\n  return ({ onComplete, onData, onStart, ...props }) => {\n    const { recording, start, stop, change } = useAudioRecord({ onComplete, onData, onStart });\n\n    return <WrappedComponent {...props} recording={recording} start={start} stop={stop} onClick={change} />;\n  };\n};\n\nexport const AudioRecordRender = ({ children, ...props }) => {\n  return children(props);\n};\n\nconst AudioRecordButton = withAudioRecord(\n  createWithRemoteLoader({\n    modules: ['components-core:LoadingButton']\n  })(({ remoteModules, recording, children, start, stop, ...props }) => {\n    const [LoadingButton] = remoteModules;\n    return <LoadingButton {...props}>{children ? children(recording) : recording ? '正在录制' : '点击开始'}</LoadingButton>;\n  })\n);\n\nexport default AudioRecordButton;\n","import { useEffect, useState, useMemo } from 'react';\nimport { Button } from 'antd';\n\nexport const useAudioPlayer = ({ src }) => {\n  const [playing, setPlaying] = useState(false);\n  const audio = useMemo(() => {\n    if (!src) {\n      return;\n    }\n    return new Audio(src instanceof Blob ? URL.createObjectURL(src) : src);\n  }, [src]);\n\n  useEffect(() => {\n    audio.addEventListener('ended', () => {\n      setPlaying(false);\n    });\n    return () => {\n      if (src instanceof Blob) {\n        URL.revokeObjectURL(audio.src);\n      }\n    };\n  }, [audio, src]);\n\n  return {\n    playing,\n    play: async () => {\n      audio.currentTime = 0;\n      await audio.play();\n      setPlaying(true);\n    },\n    pause: () => {\n      audio.pause();\n      setPlaying(false);\n    },\n    getDuration: async () => {\n      if (!audio.duration) {\n        return new Promise((resolve, reject) => {\n          audio.addEventListener('loadedmetadata', () => {\n            resolve();\n          });\n          audio.addEventListener('error', e => {\n            reject(e);\n          });\n        });\n      }\n      return audio.duration * 1000;\n    }\n  };\n};\n\nexport const withAudioPlayer = WrappedComponent => {\n  return ({ src, ...props }) => {\n    const { playing, play, pause } = useAudioPlayer({ src });\n    return (\n      <>\n        <WrappedComponent\n          {...props}\n          playing={playing}\n          onClick={() => {\n            if (playing) {\n              pause();\n            } else {\n              play();\n            }\n          }}\n        />\n      </>\n    );\n  };\n};\n\nexport const AudioPlayerRender = withAudioPlayer(({ children, ...props }) => {\n  return children(props);\n});\n\nconst AudioPlayerButton = withAudioPlayer(({ playing, ...props }) => {\n  return <Button {...props}>{playing ? '正在播放...' : '点击播放'}</Button>;\n});\n\nexport default AudioPlayerButton;\n","import { useRef, useCallback } from \"react\";\n\nconst useRefCallback = (callback, keepInit = false) => {\n  const callbackRef = useRef(callback);\n  if (!keepInit) {\n    callbackRef.current = callback;\n  }\n  return useCallback((...args) => {\n    return callbackRef.current && callbackRef.current(...args);\n  }, []);\n};\n\nexport default useRefCallback;\n","/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","import * as component_1 from '@components/Speech';\nimport * as component_2 from 'antd';\nconst readmeConfig = {\n    name: `Speech`,\n    summary: `<p>用户处理语音识别、语音转文字等，对接阿里的智能语音交互服务</p>`,\n    \n    \n    api: `<table>\n<thead>\n<tr>\n<th>属性名</th>\n<th>说明</th>\n<th>类型</th>\n<th>默认值</th>\n</tr>\n</thead>\n</table>`,\n    example: {\n        isFull: false,\n        className: `Speech_04a83`,\n        style: ``,\n        list: [{\n    title: `这里填写示例标题`,\n    description: `这里填写示例说明`,\n    code: `const { AudioRecordButton, AudioPlayerButton, useAudioPlayer } = _Speech;\nconst { useState } = React;\nconst { Button } = antd;\n\nconst DurationButton = ({ src }) => {\n  const { getDuration } = useAudioPlayer({ src });\n  return (\n    <Button\n      onClick={() => {\n        getDuration().then(time => console.log(time));\n      }}\n    >\n      获取时长\n    </Button>\n  );\n};\n\nconst BaseExample = () => {\n  const [record, setRecord] = useState(null);\n  return (\n    <>\n      <AudioRecordButton\n        onStart={() => {\n          setRecord(null);\n        }}\n        onComplete={chunks => {\n          setRecord(new Blob(chunks, { type: chunks[0].type }));\n        }}\n      />\n      {record && (\n        <>\n          <AudioPlayerButton src={record} />\n          <DurationButton src={record} />\n        </>\n      )}\n    </>\n  );\n};\n\nrender(<BaseExample />);\n\n`,\n    scope: [{\n    name: \"_Speech\",\n    packageName: \"@components/Speech\",\n    component: component_1\n},{\n    name: \"antd\",\n    packageName: \"antd\",\n    component: component_2\n}]\n}]\n    }\n};\nexport default readmeConfig;\n","import Speech from '@components/Speech/README.md';export default {Speech};\nexport const manifest = {\"name\":\"@hkyhy/components-media\",\"version\":\"0.1.2\",\"open-version\":true,\"public-url\":\"/components-media\",\"modules\":[{\"name\":\"Speech\",\"baseDir\":\"/home/runner/work/components-media/components-media/src/components/Speech\"}]};"],"names":["useAudioRecord","options","onComplete","onData","onStart","Object","assign","recording","setRecording","useState","audioRef","useRef","message","App","useApp","handlerComplete","useRefCallback","handlerData","handlerStart","start","async","stream","window","navigator","mediaDevices","getUserMedia","audio","catch","e","error","recorder","MediaRecorder","current","events","chunks","data","push","forEach","_ref","name","handler","addEventListener","stop","isUnmount","_ref2","removeEventListener","getTracks","track","change","withAudioRecord","WrappedComponent","_ref3","props","_jsx","onClick","AudioRecordRender","_ref4","children","createWithRemoteLoader","modules","_ref5","remoteModules","LoadingButton","useAudioPlayer","src","playing","setPlaying","useMemo","Audio","Blob","URL","createObjectURL","useEffect","revokeObjectURL","play","currentTime","pause","getDuration","duration","Promise","resolve","reject","withAudioPlayer","_Fragment","AudioPlayerRender","Button","callback","keepInit","arguments","length","undefined","callbackRef","useCallback","f","require","k","Symbol","for","l","m","prototype","hasOwnProperty","n","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentOwner","p","key","ref","__self","__source","q","c","a","g","b","d","h","call","defaultProps","$$typeof","type","_owner","exports","Fragment","jsx","module","Speech","summary","api","example","isFull","className","style","list","title","description","code","scope","packageName","component","manifest"],"sourceRoot":""}