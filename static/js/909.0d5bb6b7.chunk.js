/*! For license information please see 909.0d5bb6b7.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunk_hkyhy_components_media=self.webpackChunk_hkyhy_components_media||[]).push([[116,379,909],{5909:(e,r,t)=>{t.r(r),t.d(r,{AudioPlayerButton:()=>j,AudioPlayerRender:()=>w,AudioRecordButton:()=>b,AudioRecordRender:()=>m,useAudioPlayer:()=>g,useAudioRecord:()=>f,withAudioPlayer:()=>O,withAudioRecord:()=>y});var n=t(9379),o=t(3986),a=t(3884),c=t(5199),i=t(1400),u=t(3050),s=t(579);const l=["onComplete","onData","onStart"],d=["children"],p=["remoteModules","recording","children","start","stop"],f=e=>{const{onComplete:r,onData:t,onStart:n}=Object.assign({},e),[o,u]=(0,a.useState)(!1),s=(0,a.useRef)([]),{message:l}=c.App.useApp(),d=(0,i.A)(r),p=(0,i.A)(t),f=(0,i.A)(n),y=(0,i.A)((async()=>{const e=await window.navigator.mediaDevices.getUserMedia({audio:!0}).catch((e=>{throw l.error("\u51fa\u9519\uff0c\u8bf7\u786e\u4fdd\u5df2\u5141\u8bb8\u6d4f\u89c8\u5668\u83b7\u53d6\u5f55\u97f3\u6743\u9650"),e})),r=new window.MediaRecorder(e);s.current={stream:e,recorder:r};const t=[["start",()=>{s.current.chunks=[],f({stream:e,recorder:r})}],["dataavailable",e=>{p(e.data),s.current.chunks.push(e.data)}]];return s.current.events=t,t.forEach((e=>{let[t,n]=e;return r.addEventListener(t,n)})),r.start(1e3),u(!0),{stream:e,recorder:r}})),m=(0,i.A)((async e=>{if(!e&&u(!1),!s.current)return[];const{events:r,recorder:t,stream:n,chunks:o}=s.current;return r.forEach((e=>{let[r,n]=e;return t.removeEventListener(r,n)})),n.getTracks().forEach((e=>e.stop())),s.current=null,await d(o),o})),b=(0,i.A)((async()=>{o?await m():await y()}));return{recording:o,start:y,stop:m,change:b}},y=e=>r=>{let{onComplete:t,onData:a,onStart:c}=r,i=(0,o.A)(r,l);const{recording:u,start:d,stop:p,change:y}=f({onComplete:t,onData:a,onStart:c});return(0,s.jsx)(e,(0,n.A)((0,n.A)({},i),{},{recording:u,start:d,stop:p,onClick:y}))},m=e=>{let{children:r}=e;return r((0,o.A)(e,d))},b=y((0,u.createWithRemoteLoader)({modules:["components-core:LoadingButton"]})((e=>{let{remoteModules:r,recording:t,children:a,start:c,stop:i}=e,u=(0,o.A)(e,p);const[l]=r;return(0,s.jsx)(l,(0,n.A)((0,n.A)({},u),{},{children:a?a(t):t?"\u6b63\u5728\u5f55\u5236":"\u70b9\u51fb\u5f00\u59cb"}))}))),A=["src"],v=["children"],h=["playing"],g=e=>{let{src:r}=e;const[t,n]=(0,a.useState)(!1),o=(0,a.useMemo)((()=>{if(r)return new Audio(r instanceof Blob?URL.createObjectURL(r):r)}),[r]);return(0,a.useEffect)((()=>(o.addEventListener("ended",(()=>{n(!1)})),()=>{r instanceof Blob&&URL.revokeObjectURL(o.src)})),[o,r]),{playing:t,play:async()=>{o.currentTime=0,await o.play(),n(!0)},pause:()=>{o.pause(),n(!1)},getDuration:async()=>o.duration?1e3*o.duration:new Promise(((e,r)=>{o.addEventListener("loadedmetadata",(()=>{e()})),o.addEventListener("error",(e=>{r(e)}))}))}},O=e=>r=>{let{src:t}=r,a=(0,o.A)(r,A);const{playing:c,play:i,pause:u}=g({src:t});return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(e,(0,n.A)((0,n.A)({},a),{},{playing:c,onClick:()=>{c?u():i()}}))})},w=O((e=>{let{children:r}=e;return r((0,o.A)(e,v))})),j=O((e=>{let{playing:r}=e,t=(0,o.A)(e,h);return(0,s.jsx)(c.Button,(0,n.A)((0,n.A)({},t),{},{children:r?"\u6b63\u5728\u64ad\u653e...":"\u70b9\u51fb\u64ad\u653e"}))}))},1400:(e,r,t)=>{t.d(r,{A:()=>o});var n=t(3884);const o=function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const t=(0,n.useRef)(e);return r||(t.current=e),(0,n.useCallback)((function(){return t.current&&t.current(...arguments)}),[])}},1153:(e,r,t)=>{var n=t(3884),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function s(e,r,t){var n,a={},s=null,l=null;for(n in void 0!==t&&(s=""+t),void 0!==r.key&&(s=""+r.key),void 0!==r.ref&&(l=r.ref),r)c.call(r,n)&&!u.hasOwnProperty(n)&&(a[n]=r[n]);if(e&&e.defaultProps)for(n in r=e.defaultProps)void 0===a[n]&&(a[n]=r[n]);return{$$typeof:o,type:e,key:s,ref:l,props:a,_owner:i.current}}r.Fragment=a,r.jsx=s},579:(e,r,t)=>{e.exports=t(1153)},4467:(e,r,t)=>{t.d(r,{A:()=>o});var n=t(816);function o(e,r,t){return(r=(0,n.A)(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}},9379:(e,r,t)=>{t.d(r,{A:()=>a});var n=t(4467);function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function a(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){(0,n.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}},3986:(e,r,t)=>{function n(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.includes(n))continue;t[n]=e[n]}return t}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.includes(t)||{}.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}t.d(r,{A:()=>n})},816:(e,r,t)=>{t.d(r,{A:()=>o});var n=t(2284);function o(e){var r=function(e,r){if("object"!=(0,n.A)(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,r||"default");if("object"!=(0,n.A)(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==(0,n.A)(r)?r:r+""}},2284:(e,r,t)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}t.d(r,{A:()=>n})}}]);
//# sourceMappingURL=909.0d5bb6b7.chunk.js.map