(self.webpackChunk_hkyhy_components_media=self.webpackChunk_hkyhy_components_media||[]).push([[675],{5764:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=5764,e.exports=t},6635:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(5909),o=n(5199);const a={name:"Speech",summary:"<p>\u7528\u6237\u5904\u7406\u8bed\u97f3\u8bc6\u522b\u3001\u8bed\u97f3\u8f6c\u6587\u5b57\u7b49\uff0c\u5bf9\u63a5\u963f\u91cc\u7684\u667a\u80fd\u8bed\u97f3\u4ea4\u4e92\u670d\u52a1</p>",api:"<table>\n<thead>\n<tr>\n<th>\u5c5e\u6027\u540d</th>\n<th>\u8bf4\u660e</th>\n<th>\u7c7b\u578b</th>\n<th>\u9ed8\u8ba4\u503c</th>\n</tr>\n</thead>\n</table>",example:{isFull:!1,className:"Speech_04a83",style:"",list:[{title:"\u8fd9\u91cc\u586b\u5199\u793a\u4f8b\u6807\u9898",description:"\u8fd9\u91cc\u586b\u5199\u793a\u4f8b\u8bf4\u660e",code:"const { AudioRecordButton, AudioPlayerButton, useAudioPlayer } = _Speech;\nconst { useState } = React;\nconst { Button } = antd;\n\nconst DurationButton = ({ src }) => {\n  const { getDuration } = useAudioPlayer({ src });\n  return (\n    <Button\n      onClick={() => {\n        getDuration().then(time => console.log(time));\n      }}\n    >\n      \u83b7\u53d6\u65f6\u957f\n    </Button>\n  );\n};\n\nconst BaseExample = () => {\n  const [record, setRecord] = useState(null);\n  return (\n    <>\n      <AudioRecordButton\n        onStart={() => {\n          setRecord(null);\n        }}\n        onComplete={chunks => {\n          setRecord(new Blob(chunks, { type: chunks[0].type }));\n        }}\n      />\n      {record && (\n        <>\n          <AudioPlayerButton src={record} />\n          <DurationButton src={record} />\n        </>\n      )}\n    </>\n  );\n};\n\nrender(<BaseExample />);\n\n",scope:[{name:"_Speech",packageName:"@components/Speech",component:r},{name:"antd",packageName:"antd",component:o}]}]}}},1448:(e,t,n)=>{"use strict";var r=n(3884),o=n.n(r),a=n(9379),s=n(7558),c=n(5199),d=n(9946),u=n.n(d),i=n(3050),l=n(1488),m=n.n(l),p=n(579);window.PUBLIC_URL=window.runtimePublicUrl||"";var h=n(4391),A=n(3986),g=n(4679),y=n(4152),f=n.n(y),k=(n(1296),n(6446));const w=["globalPreset"],v=f().ExampleRoutes,R=e=>{let{globalPreset:t}=e,n=(0,A.A)(e,w);return(0,p.jsx)(g.HashRouter,{children:(0,p.jsx)(v,(0,a.A)((0,a.A)({},n),{},{paths:[{key:"components",path:"/",title:"\u9996\u9875"}],preset:t,themeToken:t.themeToken,readme:k.default}))})},B=h.createRoot(document.getElementById("root"));(async e=>{const t=await(async()=>{const e=(()=>{const e=u().create({validateStatus:function(){return!0}});return e.interceptors.response.use((e=>{var t;return 200!==e.status&&!1!==e.showError&&!1!==e.config.showError&&c.message.error((null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.msg)||"\u8bf7\u6c42\u53d1\u751f\u9519\u8bef"),e}),(e=>(c.message.error(e.message||"\u8bf7\u6c42\u53d1\u751f\u9519\u8bef"),Promise.reject(e)))),t=>t.hasOwnProperty("loader")&&"function"===typeof t.loader?Promise.resolve(t.loader(m()(t,["loader"]))).then((e=>({data:{code:0,data:e}}))).catch((e=>(c.message.error(e.message||"\u8bf7\u6c42\u53d1\u751f\u9519\u8bef"),{data:{code:500,msg:e.message}}))):e(t)})();(0,s.preset)({ajax:e,loading:(0,p.jsx)(c.Spin,{delay:500,style:{position:"absolute",left:"50%",padding:"10px",transform:"translateX(-50%)"}}),error:null,empty:(0,p.jsx)(c.Empty,{}),transformResponse:e=>{const{data:t}=e;return e.data={code:0===t.code?200:t.code,msg:t.msg,results:t.data},e}});const t={url:"https://uc.fatalent.cn",tpl:"{{url}}/packages/@kne-components/{{remote}}/{{version}}/build"},n=(0,a.A)((0,a.A)({},t),{},{remote:"components-core",defaultVersion:"0.2.81"});return(0,i.preset)({remotes:{default:n,"components-core":n,"components-iconfont":(0,a.A)((0,a.A)({},t),{},{remote:"components-iconfont",defaultVersion:"0.1.8"}),"components-media":(0,a.A)((0,a.A)({},t),{},{remote:"components-media",defaultVersion:"0.1.2"})}}),{ajax:e,themeToken:{colorPrimary:"#4F185A",colorPrimaryHover:"#702280"}}})();B.render((0,p.jsx)(o().StrictMode,{children:(0,p.jsx)(e,{themeToken:t.themeToken,globalPreset:t})}))})(R)},5909:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AudioPlayerButton:()=>B,AudioPlayerRender:()=>R,AudioRecordButton:()=>g,AudioRecordRender:()=>A,useAudioPlayer:()=>w,useAudioRecord:()=>p,withAudioPlayer:()=>v,withAudioRecord:()=>h});var r=n(9379),o=n(3986),a=n(3884),s=n(5199),c=n(1400),d=n(3050),u=n(579);const i=["onComplete","onData","onStart"],l=["children"],m=["remoteModules","recording","children","start","stop"],p=e=>{const{onComplete:t,onData:n,onStart:r}=Object.assign({},e),[o,d]=(0,a.useState)(!1),u=(0,a.useRef)([]),{message:i}=s.App.useApp(),l=(0,c.A)(t),m=(0,c.A)(n),p=(0,c.A)(r),h=(0,c.A)((async()=>{const e=await window.navigator.mediaDevices.getUserMedia({audio:!0}).catch((e=>{throw i.error("\u51fa\u9519\uff0c\u8bf7\u786e\u4fdd\u5df2\u5141\u8bb8\u6d4f\u89c8\u5668\u83b7\u53d6\u5f55\u97f3\u6743\u9650"),e})),t=new window.MediaRecorder(e);u.current={stream:e,recorder:t};const n=[["start",()=>{u.current.chunks=[],p({stream:e,recorder:t})}],["dataavailable",e=>{m(e.data),u.current.chunks.push(e.data)}]];return u.current.events=n,n.forEach((e=>{let[n,r]=e;return t.addEventListener(n,r)})),t.start(1e3),d(!0),{stream:e,recorder:t}})),A=(0,c.A)((async e=>{if(!e&&d(!1),!u.current)return[];const{events:t,recorder:n,stream:r,chunks:o}=u.current;return t.forEach((e=>{let[t,r]=e;return n.removeEventListener(t,r)})),r.getTracks().forEach((e=>e.stop())),u.current=null,await l(o),o})),g=(0,c.A)((async()=>{o?await A():await h()}));return{recording:o,start:h,stop:A,change:g}},h=e=>t=>{let{onComplete:n,onData:a,onStart:s}=t,c=(0,o.A)(t,i);const{recording:d,start:l,stop:m,change:h}=p({onComplete:n,onData:a,onStart:s});return(0,u.jsx)(e,(0,r.A)((0,r.A)({},c),{},{recording:d,start:l,stop:m,onClick:h}))},A=e=>{let{children:t}=e;return t((0,o.A)(e,l))},g=h((0,d.createWithRemoteLoader)({modules:["components-core:LoadingButton"]})((e=>{let{remoteModules:t,recording:n,children:a,start:s,stop:c}=e,d=(0,o.A)(e,m);const[i]=t;return(0,u.jsx)(i,(0,r.A)((0,r.A)({},d),{},{children:a?a(n):n?"\u6b63\u5728\u5f55\u5236":"\u70b9\u51fb\u5f00\u59cb"}))}))),y=["src"],f=["children"],k=["playing"],w=e=>{let{src:t}=e;const[n,r]=(0,a.useState)(!1),o=(0,a.useMemo)((()=>{if(t)return new Audio(t instanceof Blob?URL.createObjectURL(t):t)}),[t]);return(0,a.useEffect)((()=>(o.addEventListener("ended",(()=>{r(!1)})),()=>{t instanceof Blob&&URL.revokeObjectURL(o.src)})),[o,t]),{playing:n,play:async()=>{o.currentTime=0,await o.play(),r(!0)},pause:()=>{o.pause(),r(!1)},getDuration:async()=>o.duration?1e3*o.duration:new Promise(((e,t)=>{o.addEventListener("loadedmetadata",(()=>{e()})),o.addEventListener("error",(e=>{t(e)}))}))}},v=e=>t=>{let{src:n}=t,a=(0,o.A)(t,y);const{playing:s,play:c,pause:d}=w({src:n});return(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(e,(0,r.A)((0,r.A)({},a),{},{playing:s,onClick:()=>{s?d():c()}}))})},R=v((e=>{let{children:t}=e;return t((0,o.A)(e,f))})),B=v((e=>{let{playing:t}=e,n=(0,o.A)(e,k);return(0,u.jsx)(s.Button,(0,r.A)((0,r.A)({},n),{},{children:t?"\u6b63\u5728\u64ad\u653e...":"\u70b9\u51fb\u64ad\u653e"}))}))}}]);
//# sourceMappingURL=675.251624a6.chunk.js.map