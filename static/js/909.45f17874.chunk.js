/*! For license information please see 909.45f17874.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunk_hkyhy_components_media=self.webpackChunk_hkyhy_components_media||[]).push([[909],{5909:(e,r,t)=>{t.r(r),t.d(r,{AudioPlayerButton:()=>h,AudioPlayerRender:()=>f,AudioRecordButton:()=>l,AudioRecordRender:()=>d,useAudioPlayer:()=>p,useAudioRecord:()=>u,withAudioPlayer:()=>y,withAudioRecord:()=>i});var n=t(3884),o=t(5199),a=t(1400),s=t(3050),c=t(579);const u=e=>{const{onComplete:r,onData:t,onStart:s}=Object.assign({},e),[c,u]=(0,n.useState)(!1),i=(0,n.useRef)([]),{message:d}=o.App.useApp(),l=(0,a.A)(r),p=(0,a.A)(t),y=(0,a.A)(s),f=(0,a.A)((async()=>{const e=await window.navigator.mediaDevices.getUserMedia({audio:!0}).catch((e=>{throw d.error("\u51fa\u9519\uff0c\u8bf7\u786e\u4fdd\u5df2\u5141\u8bb8\u6d4f\u89c8\u5668\u83b7\u53d6\u5f55\u97f3\u6743\u9650"),e})),r=new window.MediaRecorder(e);i.current={stream:e,recorder:r};const t=[["start",()=>{i.current.chunks=[],y({stream:e,recorder:r})}],["dataavailable",e=>{p(e.data),i.current.chunks.push(e.data)}]];return i.current.events=t,t.forEach((e=>{let[t,n]=e;return r.addEventListener(t,n)})),r.start(1e3),u(!0),{stream:e,recorder:r}})),h=(0,a.A)((async e=>{if(!e&&u(!1),!i.current)return[];const{events:r,recorder:t,stream:n,chunks:o}=i.current;return r.forEach((e=>{let[r,n]=e;return t.removeEventListener(r,n)})),n.getTracks().forEach((e=>e.stop())),i.current=null,await l(o),o})),m=(0,a.A)((async()=>{c?await h():await f()}));return{recording:c,start:f,stop:h,change:m}},i=e=>r=>{let{onComplete:t,onData:n,onStart:o,...a}=r;const{recording:s,start:i,stop:d,change:l}=u({onComplete:t,onData:n,onStart:o});return(0,c.jsx)(e,{...a,recording:s,start:i,stop:d,onClick:l})},d=e=>{let{children:r,...t}=e;return r(t)},l=i((0,s.createWithRemoteLoader)({modules:["components-core:LoadingButton"]})((e=>{let{remoteModules:r,recording:t,children:n,start:o,stop:a,...s}=e;const[u]=r;return(0,c.jsx)(u,{...s,children:n?n(t):t?"\u6b63\u5728\u5f55\u5236":"\u70b9\u51fb\u5f00\u59cb"})}))),p=e=>{let{src:r}=e;const[t,o]=(0,n.useState)(!1),a=(0,n.useMemo)((()=>{if(r)return new Audio(r instanceof Blob?URL.createObjectURL(r):r)}),[r]);return(0,n.useEffect)((()=>(a.addEventListener("ended",(()=>{o(!1)})),()=>{r instanceof Blob&&URL.revokeObjectURL(a.src)})),[a,r]),{playing:t,play:async()=>{a.currentTime=0,await a.play(),o(!0)},pause:()=>{a.pause(),o(!1)},getDuration:async()=>a.duration?1e3*a.duration:new Promise(((e,r)=>{a.addEventListener("loadedmetadata",(()=>{e()})),a.addEventListener("error",(e=>{r(e)}))}))}},y=e=>r=>{let{src:t,...n}=r;const{playing:o,play:a,pause:s}=p({src:t});return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(e,{...n,playing:o,onClick:()=>{o?s():a()}})})},f=y((e=>{let{children:r,...t}=e;return r(t)})),h=y((e=>{let{playing:r,...t}=e;return(0,c.jsx)(o.Button,{...t,children:r?"\u6b63\u5728\u64ad\u653e...":"\u70b9\u51fb\u64ad\u653e"})}))},1400:(e,r,t)=>{t.d(r,{A:()=>o});var n=t(3884);const o=function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const t=(0,n.useRef)(e);return r||(t.current=e),(0,n.useCallback)((function(){return t.current&&t.current(...arguments)}),[])}},1153:(e,r,t)=>{var n=t(3884),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,c=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function i(e,r,t){var n,a={},i=null,d=null;for(n in void 0!==t&&(i=""+t),void 0!==r.key&&(i=""+r.key),void 0!==r.ref&&(d=r.ref),r)s.call(r,n)&&!u.hasOwnProperty(n)&&(a[n]=r[n]);if(e&&e.defaultProps)for(n in r=e.defaultProps)void 0===a[n]&&(a[n]=r[n]);return{$$typeof:o,type:e,key:i,ref:d,props:a,_owner:c.current}}r.Fragment=a,r.jsx=i},579:(e,r,t)=>{e.exports=t(1153)}}]);
//# sourceMappingURL=909.45f17874.chunk.js.map