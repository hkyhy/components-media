/*! For license information please see 99.82bfc9b8.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunk_hkyhy_components_media=self.webpackChunk_hkyhy_components_media||[]).push([[99,909],{5909:(e,n,t)=>{t.r(n),t.d(n,{AudioPlayerButton:()=>y,AudioPlayerRender:()=>h,AudioRecordButton:()=>l,AudioRecordRender:()=>d,useAudioPlayer:()=>p,useAudioRecord:()=>u,withAudioPlayer:()=>m,withAudioRecord:()=>i});var r=t(3884),o=t(5199),a=t(1400),c=t(3050),s=t(579);const u=e=>{const{onComplete:n,onData:t,onStart:c}=Object.assign({},e),[s,u]=(0,r.useState)(!1),i=(0,r.useRef)([]),{message:d}=o.App.useApp(),l=(0,a.A)(n),p=(0,a.A)(t),m=(0,a.A)(c),h=(0,a.A)((async()=>{const e=await window.navigator.mediaDevices.getUserMedia({audio:!0}).catch((e=>{throw d.error("\u51fa\u9519\uff0c\u8bf7\u786e\u4fdd\u5df2\u5141\u8bb8\u6d4f\u89c8\u5668\u83b7\u53d6\u5f55\u97f3\u6743\u9650"),e})),n=new window.MediaRecorder(e);i.current={stream:e,recorder:n};const t=[["start",()=>{i.current.chunks=[],m({stream:e,recorder:n})}],["dataavailable",e=>{p(e.data),i.current.chunks.push(e.data)}]];return i.current.events=t,t.forEach((e=>{let[t,r]=e;return n.addEventListener(t,r)})),n.start(1e3),u(!0),{stream:e,recorder:n}})),y=(0,a.A)((async e=>{if(!e&&u(!1),!i.current)return[];const{events:n,recorder:t,stream:r,chunks:o}=i.current;return n.forEach((e=>{let[n,r]=e;return t.removeEventListener(n,r)})),r.getTracks().forEach((e=>e.stop())),i.current=null,await l(o),o})),f=(0,a.A)((async()=>{s?await y():await h()}));return{recording:s,start:h,stop:y,change:f}},i=e=>n=>{let{onComplete:t,onData:r,onStart:o,...a}=n;const{recording:c,start:i,stop:d,change:l}=u({onComplete:t,onData:r,onStart:o});return(0,s.jsx)(e,{...a,recording:c,start:i,stop:d,onClick:l})},d=e=>{let{children:n,...t}=e;return n(t)},l=i((0,c.createWithRemoteLoader)({modules:["components-core:LoadingButton"]})((e=>{let{remoteModules:n,recording:t,children:r,start:o,stop:a,...c}=e;const[u]=n;return(0,s.jsx)(u,{...c,children:r?r(t):t?"\u6b63\u5728\u5f55\u5236":"\u70b9\u51fb\u5f00\u59cb"})}))),p=e=>{let{src:n}=e;const[t,o]=(0,r.useState)(!1),a=(0,r.useMemo)((()=>{if(n)return new Audio(n instanceof Blob?URL.createObjectURL(n):n)}),[n]);return(0,r.useEffect)((()=>(a.addEventListener("ended",(()=>{o(!1)})),()=>{n instanceof Blob&&URL.revokeObjectURL(a.src)})),[a,n]),{playing:t,play:async()=>{a.currentTime=0,await a.play(),o(!0)},pause:()=>{a.pause(),o(!1)},getDuration:async()=>a.duration?1e3*a.duration:new Promise(((e,n)=>{a.addEventListener("loadedmetadata",(()=>{e()})),a.addEventListener("error",(e=>{n(e)}))}))}},m=e=>n=>{let{src:t,...r}=n;const{playing:o,play:a,pause:c}=p({src:t});return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(e,{...r,playing:o,onClick:()=>{o?c():a()}})})},h=m((e=>{let{children:n,...t}=e;return n(t)})),y=m((e=>{let{playing:n,...t}=e;return(0,s.jsx)(o.Button,{...t,children:n?"\u6b63\u5728\u64ad\u653e...":"\u70b9\u51fb\u64ad\u653e"})}))},1400:(e,n,t)=>{t.d(n,{A:()=>o});var r=t(3884);const o=function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const t=(0,r.useRef)(e);return n||(t.current=e),(0,r.useCallback)((function(){return t.current&&t.current(...arguments)}),[])}},1153:(e,n,t)=>{var r=t(3884),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function i(e,n,t){var r,a={},i=null,d=null;for(r in void 0!==t&&(i=""+t),void 0!==n.key&&(i=""+n.key),void 0!==n.ref&&(d=n.ref),n)c.call(n,r)&&!u.hasOwnProperty(r)&&(a[r]=n[r]);if(e&&e.defaultProps)for(r in n=e.defaultProps)void 0===a[r]&&(a[r]=n[r]);return{$$typeof:o,type:e,key:i,ref:d,props:a,_owner:s.current}}n.Fragment=a,n.jsx=i},579:(e,n,t)=>{e.exports=t(1153)},7099:(e,n,t)=>{t.r(n),t.d(n,{default:()=>r,manifest:()=>o});const r={Speech:{name:"Speech",summary:"<p>\u7528\u6237\u5904\u7406\u8bed\u97f3\u8bc6\u522b\u3001\u8bed\u97f3\u8f6c\u6587\u5b57\u7b49\uff0c\u5bf9\u63a5\u963f\u91cc\u7684\u667a\u80fd\u8bed\u97f3\u4ea4\u4e92\u670d\u52a1</p>",api:"<table>\n<thead>\n<tr>\n<th>\u5c5e\u6027\u540d</th>\n<th>\u8bf4\u660e</th>\n<th>\u7c7b\u578b</th>\n<th>\u9ed8\u8ba4\u503c</th>\n</tr>\n</thead>\n</table>",example:{isFull:!1,className:"Speech_04a83",style:"",list:[{title:"\u8fd9\u91cc\u586b\u5199\u793a\u4f8b\u6807\u9898",description:"\u8fd9\u91cc\u586b\u5199\u793a\u4f8b\u8bf4\u660e",code:"const { AudioRecordButton, AudioPlayerButton, useAudioPlayer } = _Speech;\nconst { useState } = React;\nconst { Button } = antd;\n\nconst DurationButton = ({ src }) => {\n  const { getDuration } = useAudioPlayer({ src });\n  return (\n    <Button\n      onClick={() => {\n        getDuration().then(time => console.log(time));\n      }}\n    >\n      \u83b7\u53d6\u65f6\u957f\n    </Button>\n  );\n};\n\nconst BaseExample = () => {\n  const [record, setRecord] = useState(null);\n  return (\n    <>\n      <AudioRecordButton\n        onStart={() => {\n          setRecord(null);\n        }}\n        onComplete={chunks => {\n          setRecord(new Blob(chunks, { type: chunks[0].type }));\n        }}\n      />\n      {record && (\n        <>\n          <AudioPlayerButton src={record} />\n          <DurationButton src={record} />\n        </>\n      )}\n    </>\n  );\n};\n\nrender(<BaseExample />);\n\n",scope:[{name:"_Speech",packageName:"@components/Speech",component:t(5909)},{name:"antd",packageName:"antd",component:t(5199)}]}]}}},o={name:"@hkyhy/components-media",version:"0.1.2","open-version":!0,"public-url":"/ui_components/@hkyhy/components-media/0.1.2",modules:[{name:"Speech",baseDir:"/home/runner/work/components-media/components-media/src/components/Speech"}]}}}]);
//# sourceMappingURL=99.82bfc9b8.chunk.js.map